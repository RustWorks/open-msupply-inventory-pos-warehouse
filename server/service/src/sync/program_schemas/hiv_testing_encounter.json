{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "EncounterStatus": {
      "enum": ["SCHEDULED", "DONE", "CANCELLED"],
      "type": "string"
    },
    "FamilyPlanning": {
      "properties": {
        "contraception": {
          "description": "13197004 Contraception",
          "type": "boolean"
        },
        "pregnant": {
          "description": "77386006 Pregnant",
          "type": "boolean"
        }
      },
      "type": "object"
    },
    "HIVRiskGroup": {
      "enum": [
        "LRM",
        "MSM",
        "MSW",
        "MSMSW",
        "HRM",
        "LRW",
        "HRW",
        "FSW",
        "TG",
        "TGSW"
      ],
      "type": "string"
    },
    "HIVStatus": {
      "enum": ["POSITIVE", "NEGATIVE", "UNKNOWN"],
      "type": "string"
    },
    "HIVTestType": {
      "enum": ["PCR", "ANTIBODY"],
      "type": "string"
    },
    "HIVTestingEncounter": {
      "properties": {
        "endDatetime": {
          "description": "Encounter end date and time",
          "format": "date-time",
          "type": "string"
        },
        "familyPlanning": {
          "$ref": "#/definitions/FamilyPlanning"
        },
        "hivTesting": {
          "properties": {
            "datetime": {
              "description": "Date of HIV Test done",
              "format": "date-time",
              "type": "string"
            },
            "result": {
              "$ref": "#/definitions/HIVStatus"
            },
            "type": {
              "$ref": "#/definitions/HIVTestType"
            }
          },
          "required": ["datetime", "type", "result"],
          "type": "object"
        },
        "practitioner": {
          "$ref": "#/definitions/Practitioner"
        },
        "riskBehaviour": {
          "properties": {
            "accidentalNeedlePick": {
              "description": "Have you received any of the following in the past 12 months ?: Accidental needle pick ?",
              "type": "boolean"
            },
            "forcedSexWithoutConsent": {
              "description": "Have you received any of the following in the past 12 months ?: Forced to have sex without consent ?",
              "type": "boolean"
            },
            "injectedDrugsWithoutDoctorAdvice": {
              "description": "Have you received any of the following in the past 12 months ?: Injected drugs without doctor's advice ?",
              "type": "boolean"
            },
            "numberFemaleSexualPartners6Month": {
              "description": "How many female sexual partners have you had in the last 6 months ?",
              "type": "number"
            },
            "numberMaleSexualPartners6Month": {
              "description": "How many male sexual partners have you had in the last 6 months ?",
              "type": "number"
            },
            "prostitution": {
              "description": "Have you received any of the following in the past 12 months ?: Sex in exchange for money/goods/services ?",
              "type": "boolean"
            },
            "receivedBloodTransfusion": {
              "description": "Have you received any of the following in the past 12 months ?: Received a blood transfusion ?",
              "type": "boolean"
            },
            "riskGroup": {
              "$ref": "#/definitions/HIVRiskGroup"
            },
            "sexWithSameSex": {
              "description": "Have you received any of the following in the past 12 months ?: Had sex with someone of the same sex ?",
              "type": "boolean"
            },
            "sexualTransmittedInfection": {
              "description": "Have you received any of the following in the past 12 months ?: Sexually transmitted infection (STI)",
              "type": "boolean"
            },
            "unprotectedAnalSex": {
              "description": "Have you received any of the following in the past 12 months ?: Unprotected anal sex ?",
              "type": "boolean"
            },
            "unprotectedVaginalSex": {
              "description": "Have you received any of the following in the past 12 months ?: Unprotected vaginal sex ?",
              "type": "boolean"
            }
          },
          "type": "object"
        },
        "startDatetime": {
          "description": "Encounter start date and time",
          "format": "date-time",
          "type": "string"
        },
        "status": {
          "$ref": "#/definitions/EncounterStatus"
        }
      },
      "required": ["startDatetime"],
      "type": "object"
    },
    "Practitioner": {
      "properties": {
        "firstName": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "lastName": {
          "type": "string"
        }
      },
      "type": "object"
    }
  },
  "type": "object",
  "allOf": [
    {
      "$ref": "#/definitions/HIVTestingEncounter"
    }
  ]
}
