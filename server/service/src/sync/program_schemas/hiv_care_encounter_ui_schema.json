{
  "type": "Categorization",
  "omSupply": {
    "some": "extra",
    "data": 1
  },
  "elements": [
    {
      "type": "Category",
      "label": "Visit Type",
      "options": {
        "icon": "visit"
      },
      "elements": [
        {
          "type": "Control",
          "label": "Visit Type:",
          "scope": "#/properties/visit/properties/visitType"
        },
        {
          "type": "Control",
          "scope": "#/properties/visit/properties/location",
          "rule": {
            "effect": "SHOW",
            "condition": {
              "scope": "#/properties/visit/properties/visitType",
              "schema": {
                "enum": ["Outreach", "Refill"]
              }
            }
          }
        }
      ]
    },
    {
      "type": "Category",
      "label": "Physical Exam",
      "options": {
        "icon": "stethoscope"
      },
      "elements": [
        {
          "type": "Control",
          "scope": "#/properties/physicalExamination/properties/height",
          "options": {
            "width": "100px"
          }
        },
        {
          "type": "Control",
          "scope": "#/properties/physicalExamination/properties/midUpperArmCircumference",
          "options": {
            "width": "100px"
          }
        },
        {
          "type": "Control",
          "scope": "#/properties/physicalExamination/properties/weight",
          "options": {
            "width": "100px"
          }
        },
        {
          "type": "BMI",
          "scope": "#/properties/physicalExamination/properties",
          "label": "Body Mass Index (BMI)"
        },
        {
          "type": "Group",
          "label": "Blood Pressure",
          "elements": [
            {
              "type": "Control",
              "label": "Systolic",
              "scope": "#/properties/physicalExamination/properties/bloodPressure/properties/systolic"
            },
            {
              "type": "Control",
              "label": "Diastolic",
              "scope": "#/properties/physicalExamination/properties/bloodPressure/properties/diastolic"
            }
          ]
        },
        {
          "type": "Group",
          "label": "Nutrition",
          "elements": [
            {
              "type": "Control",
              "label": "Nutritional Status:",
              "scope": "#/properties/physicalExamination/properties/nutrition/properties/nutritionalStatus",
              "options": {
                "show": [
                  ["UNDER_NOURISHED", "Under nourished"],
                  ["WELL_NOURISHED", "Well nourished"],
                  ["OVERWEIGHT", "Overweight"]
                ]
              }
            },
            {
              "type": "Control",
              "label": "Nutritional Support Needed:",
              "scope": "#/properties/physicalExamination/properties/nutrition/properties/nutritionalSupportNeeded"
            }
          ]
        },
        {
          "type": "Control",
          "scope": "#/properties/physicalExamination/properties/symptoms"
        },
        {
          "type": "Control",
          "scope": "#/properties/physicalExamination/properties/opportunisticInfections"
        },
        {
          "type": "Control",
          "label": "WHO Staging:",
          "scope": "#/properties/physicalExamination/properties/whoStaging",
          "options": {
            "show": [
              ["STAGE_1_ASYMPTOMATIC", "Stage 1 - Asymptomatic"],
              ["STAGE_2_MILDLY_SYMPTOMATIC", "Stage 2 - Mildly symptomatic"],
              [
                "STAGE_3_MODERATELY_SYMPTOMATIC",
                "Stage 3 - Moderately symptomatic"
              ],
              ["STAGE_4_SEVERELY_SYMPTOMATIC", "Stage 4 - Severely symptomatic"]
            ]
          }
        },
        {
          "type": "VerticalLayout",
          "elements": [
            {
              "type": "EncounterLineChart",
              "scope": "#",
              "options": {
                "values": [
                  {
                    "field": "physicalExamination.weight",
                    "label": "Weight",
                    "unit": "kg"
                  }
                ]
              }
            },
            {
              "type": "EncounterLineChart",
              "scope": "#",
              "options": {
                "values": [
                  {
                    "field": "physicalExamination.bloodPressure",
                    "label": "Blood Pressure",
                    "unit": "mmHg"
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "type": "Category",
      "label": "ARV / Medication",
      "options": {
        "icon": "medicine"
      },
      "elements": [
        {
          "type": "ProgramEvent",
          "label": "Current ARV Regimen",
          "options": {
            "eventType": "arvMedicationRegimen",
            "documentType": "HIVCareEncounter",
            "display": {
              "type": "string",
              "multiline": true,
              "rows": 2,
              "show": [
                ["1a-New", "1a-New TDF + 3TC + DTG"],
                ["1a-Old", "1a-Old TDF + 3TC + EFV"],
                ["1b-New", "1b-New ABC + 3TC + DTG"],
                ["1b-Old", "1b-Old AZT + 3TC + EFV/NVP or TDF+3TC+NVP"],
                ["2a-New", "2a-New AZT + 3TC + LPVr"],
                ["2a-Old", "2a-Old AZT + 3TC + LPVr"],
                ["2b-New", "2b-New AZT + 3TC + DTG"],
                ["2b-Old", "2b-Old TDF + 3TC + LPVr"],
                ["2c-New", "2c-New TDF + 3TC + DTG"],
                ["3a-New", "3a-New ABC + 3TC + DTG"],
                ["3a-Old", "3a-Old ABC + 3TC + EFV"],
                ["3b-New", "3b-New ABC + 3TC + LPVr"],
                [
                  "3b-Old",
                  "3b-Old ABC + 3TC + NVP or AZT + 3TC + EFV/NVP or TDF + 3TC + EFV/NVP"
                ],
                ["3c-New", "3c-New ABC + 3TC + RAL"],
                ["4a-New", "4a-New AZT + 3TC + LPVr"],
                ["4a-Old", "4a-Old TDF + 3TC + LPVr"],
                ["4b-New", "4b-New AZT + 3TC + DTG"],
                ["4b-Old", "4b-Old ABC + 3TC + LPVr"],
                ["4c-New", "4c-New ABC + 3TC + DTG"],
                ["4c-Old", "4c-Old TDF + 3TC + LPVr"],
                ["5a-New", "5a-New ABC + 3TC + LPVr"],
                ["5a-Old", "5a-Old ABC + 3TC + LPVr or AZT + 3TC + LPVr"],
                ["5b-New", "5b-New ABC + 3TC + RAL"],
                ["5b-Old", "5b-Old ABC + 3TC + NVP or AZT + 3TC + NVP"],
                ["6a-New", "6a-New ABC + 3TC + RAL"],
                ["6a-Old", "6a-Old ABC + 3TC + NVP or AZT + 3TC + NVP"],
                ["6b-New", "6b-New AZT + 3TC + RAL"],
                ["6b-Old", "6b-Old AZT + 3TC + LPVr"],
                ["6c-New", "6c-New AZT + 3TC + LPVr"],
                ["6c-Old", "6c-Old ABC + 3TC + LPVr"]
              ]
            }
          }
        },
        {
          "type": "ProgramEvent",
          "scope": "#/properties/arvMedication/properties/regimenType",
          "label": "Current Regiment Type",
          "options": {
            "eventType": "arvMedicationRegimenType",
            "documentType": "HIVCareEncounter"
          }
        },
        {
          "scope": "#/properties/arvMedication/properties/regimenStatus",
          "label": "Regimen Status:",
          "type": "Control",
          "options": {
            "show": [
              ["NO", "No ARV"],
              ["START", "Start ARV"],
              ["CONTINUE", "Continue ARV"],
              ["CHANGE", "Changes to ARV Regimen"],
              ["STOP", "Stop ARV"]
            ]
          }
        },
        {
          "type": "Group",
          "elements": [
            {
              "scope": "#/properties/arvMedication/properties/regimen",
              "type": "Control",
              "label": "New ARV Regimen:",
              "options": {
                "show": [
                  ["1a-New", "1a-New TDF + 3TC + DTG"],
                  ["1a-Old", "1a-Old TDF + 3TC + EFV"],
                  ["1b-New", "1b-New ABC + 3TC + DTG"],
                  ["1b-Old", "1b-Old AZT + 3TC + EFV/NVP or TDF+3TC+NVP"],
                  ["2a-New", "2a-New AZT + 3TC + LPVr"],
                  ["2a-Old", "2a-Old AZT + 3TC + LPVr"],
                  ["2b-New", "2b-New AZT + 3TC + DTG"],
                  ["2b-Old", "2b-Old TDF + 3TC + LPVr"],
                  ["2c-New", "2c-New TDF + 3TC + DTG"],
                  ["3a-New", "3a-New ABC + 3TC + DTG"],
                  ["3a-Old", "3a-Old ABC + 3TC + EFV"],
                  ["3b-New", "3b-New ABC + 3TC + LPVr"],
                  [
                    "3b-Old",
                    "3b-Old ABC + 3TC + NVP or AZT + 3TC + EFV/NVP or TDF + 3TC + EFV/NVP"
                  ],
                  ["3c-New", "3c-New ABC + 3TC + RAL"],
                  ["4a-New", "4a-New AZT + 3TC + LPVr"],
                  ["4a-Old", "4a-Old TDF + 3TC + LPVr"],
                  ["4b-New", "4b-New AZT + 3TC + DTG"],
                  ["4b-Old", "4b-Old ABC + 3TC + LPVr"],
                  ["4c-New", "4c-New ABC + 3TC + DTG"],
                  ["4c-Old", "4c-Old TDF + 3TC + LPVr"],
                  ["5a-New", "5a-New ABC + 3TC + LPVr"],
                  ["5a-Old", "5a-Old ABC + 3TC + LPVr or AZT + 3TC + LPVr"],
                  ["5b-New", "5b-New ABC + 3TC + RAL"],
                  ["5b-Old", "5b-Old ABC + 3TC + NVP or AZT + 3TC + NVP"],
                  ["6a-New", "6a-New ABC + 3TC + RAL"],
                  ["6a-Old", "6a-Old ABC + 3TC + NVP or AZT + 3TC + NVP"],
                  ["6b-New", "6b-New AZT + 3TC + RAL"],
                  ["6b-Old", "6b-Old AZT + 3TC + LPVr"],
                  ["6c-New", "6c-New AZT + 3TC + LPVr"],
                  ["6c-Old", "6c-Old ABC + 3TC + LPVr"]
                ]
              },
              "rule": {
                "effect": "HIDE",
                "condition": {
                  "scope": "#/properties/arvMedication/properties/regimenStatus",
                  "schema": {
                    "enum": ["NO", "STOP"]
                  }
                }
              }
            },
            {
              "scope": "#/properties/arvMedication/properties/otherRegimen",
              "type": "Control",
              "label": "Other Regimen",
              "rule": {
                "effect": "SHOW",
                "condition": {
                  "scope": "#/properties/arvMedication/properties/regimen",
                  "schema": {
                    "enum": ["Other - please specify"]
                  }
                }
              }
            },
            {
              "type": "DecisionTree",
              "scope": "#/properties/arvMedication/properties/regimenType",
              "options": {
                "basePath": "arvMedication",
                "tree": {
                  "root": "root",
                  "nodes": {
                    "root": {
                      "branches": [
                        {
                          "dataField": "regimen",
                          "equalTo": "1a-New",
                          "value": "First Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "1a-Old",
                          "value": "First Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "1b-New",
                          "value": "First Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "1b-Old",
                          "value": "First Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "2a-New",
                          "value": "Second Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "2a-Old",
                          "value": "Second Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "2b-New",
                          "value": "Second Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "2b-Old",
                          "value": "Second Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "2c-New",
                          "value": "Second Line - Adult"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "3a-New",
                          "value": "First Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "3a-Old",
                          "value": "First Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "3b-New",
                          "value": "First Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "3b-Old",
                          "value": "First Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "3c-New",
                          "value": "First Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "4a-New",
                          "value": "Second Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "4a-Old",
                          "value": "Second Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "4b-New",
                          "value": "Second Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "4b-Old",
                          "value": "Second Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "4c-New",
                          "value": "Second Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "4c-Old",
                          "value": "Second Line - Paeds 20-30kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "5a-New",
                          "value": "First Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "5a-Old",
                          "value": "First Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "5b-New",
                          "value": "First Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "5b-Old",
                          "value": "First Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "6a-New",
                          "value": "Second Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "6a-Old",
                          "value": "Second Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "6b-New",
                          "value": "Second Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "6b-Old",
                          "value": "Second Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "6c-New",
                          "value": "Second Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "6c-Old",
                          "value": "Second Line - Paeds <20kg"
                        },
                        {
                          "dataField": "regimen",
                          "equalTo": "Other - please specify",
                          "value": "Other"
                        }
                      ]
                    }
                  }
                }
              }
            },
            {
              "scope": "#/properties/arvMedication/properties/regimenChangeReason",
              "label": "Regimen Reason:",
              "type": "Control",
              "options": {
                "multiColumn": true,
                "fieldFilter": {
                  "field": "arvMedication.regimenStatus",
                  "mapping": {
                    "NO": [
                      "51",
                      "52",
                      "53",
                      "54",
                      "55",
                      "56",
                      "57",
                      "58",
                      "99"
                    ],
                    "START": [
                      "101",
                      "102",
                      "103",
                      "104",
                      "105",
                      "106",
                      "107",
                      "108",
                      "109",
                      "151"
                    ],
                    "CHANGE": [
                      "110",
                      "111",
                      "112",
                      "113",
                      "114",
                      "115",
                      "116",
                      "117",
                      "118",
                      "119",
                      "120",
                      "121",
                      "122",
                      "123",
                      "131",
                      "132",
                      "141",
                      "142",
                      "143",
                      "144",
                      "145",
                      "146",
                      "147",
                      "148",
                      "149"
                    ],
                    "STOP": [
                      "110",
                      "111",
                      "112",
                      "113",
                      "114",
                      "115",
                      "116",
                      "117",
                      "118",
                      "119",
                      "120",
                      "121",
                      "122",
                      "123",
                      "131",
                      "132",
                      "141",
                      "142",
                      "143",
                      "144",
                      "145",
                      "146",
                      "147",
                      "148",
                      "149"
                    ]
                  }
                },
                "show": [
                  ["51", "51", "Patient does not fulfill criteria"],
                  [
                    "52",
                    "52",
                    "Patient fulfils criteria, but counseling for ARVs is ongoing"
                  ],
                  [
                    "53",
                    "53",
                    "Patient fulfils criteria, but no ARVs available"
                  ],
                  [
                    "54",
                    "54",
                    "Patient fulfils criteria, but is not willing to start"
                  ],
                  [
                    "55",
                    "55",
                    "Patient fulfils criteria, but is on TB treatment"
                  ],
                  [
                    "56",
                    "56",
                    "Patient fulfils criteria but does not start for other reason"
                  ],
                  [
                    "57",
                    "57",
                    "Patient fulfills criteria, but awaits lab results"
                  ],
                  [
                    "58",
                    "58",
                    "Fulfills criteria but has OI and is too sick to start"
                  ],
                  [
                    "99",
                    "99",
                    "Patient fulfils criteria but does not start for other reason"
                  ],
                  ["101", "101", "Adult CD4 < 200"],
                  ["102", "102", "Adult WHO Stage IV"],
                  ["103", "103", "Adult WHO Stage III, if CD4 < 350"],
                  ["104", "104", "Children Pediatric WHO Stage III"],
                  ["105", "105", "Children > 18 months, CD4% < 15%"],
                  ["106", "106", "Infants < 18 months CD4% < 20%"],
                  ["107", "107", "Pregnant women for PMCT (plus)"],
                  ["108", "108", "Other reason to start"],
                  ["109", "109", "Test and Treat"],
                  ["110", "110", "Start TB treatment"],
                  ["111", "111", "Nausea / vomiting"],
                  ["112", "112", "Diarrhoea"],
                  ["113", "113", "Headache"],
                  ["114", "114", "Fever"],
                  ["115", "115", "Skin rash"],
                  ["116", "116", "Peripheral neuropathy"],
                  ["117", "117", "Hepatitis"],
                  ["118", "118", "Jaundice"],
                  ["119", "119", "Dementia"],
                  ["120", "120", "Anaemia"],
                  ["121", "121", "Pancreatitis"],
                  ["122", "122", "CNS adverse event"],
                  ["123", "123", "Other adverse event, specify"],
                  ["131", "131", "Treatment failure, clinical"],
                  ["132", "132", "Treatment failure, immunological"],
                  ["141", "141", "Poor adherence"],
                  ["142", "142", "Patient decision"],
                  ["143", "143", "Pregnancy"],
                  ["144", "144", "End of PMTCT (plus)"],
                  ["145", "145", "Transferred out, specify where"],
                  ["146", "146", "Lost to follow-up"],
                  ["147", "147", "Patient died"],
                  ["148", "148", "Stock-out"],
                  ["149", "149", "Other reason, specify"],
                  ["151", "151", "Restart ARV after 3 or months not on ARV"]
                ]
              }
            },
            {
              "scope": "#/properties/arvMedication/properties/regimenChangeNote",
              "type": "Control"
            }
          ],
          "rule": {
            "effect": "SHOW",
            "condition": {
              "scope": "#/properties/arvMedication/properties/regimenStatus",
              "schema": {
                "enum": ["START", "CHANGE", "STOP"]
              }
            }
          }
        },
        {
          "type": "Spacer"
        },
        {
          "type": "ProgramEvent",
          "scope": "#/properties/arvMedication/properties/quantityPrescribed",
          "label": "Pill Count (at last visit end)",
          "options": {
            "eventType": "arvMedicationQuantityPrescribed",
            "documentType": "HIVCareEncounter",
            "display": {
              "type": "number"
            }
          }
        },
        {
          "type": "Control",
          "scope": "#/properties/arvMedication/properties/remainingPillCount",
          "label": "Pill Count (at visit start)"
        },
        {
          "type": "AdherenceScore",
          "scope": "#",
          "label": "Adherence Score",
          "options": {
            "previousCount": {
              "source": "EncounterEvent",
              "eventType": "arvMedicationQuantityPrescribed"
            },
            "remainingCountField": "arvMedication.remainingPillCount",
            "countPerDay": 1,
            "targetField": "arvMedication.adherenceScore"
          }
        },
        {
          "type": "QuantityDispensed",
          "scope": "#/properties/arvMedication/properties/quantityDispensed",
          "label": "Quantity of pills dispensed",
          "options": {
            "quantityPerDay": 1,
            "baseDatetimeField": "startDatetime",
            "remainingQuantityField": "arvMedication.remainingPillCount",
            "quantityPrescribedField": "arvMedication.quantityPrescribed",
            "endOfSupplyField": "arvMedication.endOfSupply",
            "totalQuantityLabel": "Pill Count (at visit end)"
          }
        },
        {
          "type": "Spacer"
        },
        {
          "scope": "#/properties/arvMedication/properties/relevantCoMedication",
          "label": "Relevant Co Medication:",
          "type": "Control"
        },
        {
          "scope": "#/properties/arvMedication/properties/prophylaxisMedication",
          "type": "Control"
        },
        {
          "type": "Spacer"
        },
        {
          "type": "EncounterLineChart",
          "scope": "#",
          "options": {
            "values": [
              {
                "field": "arvMedication.adherenceScore",
                "label": "Adherence Score",
                "unit": "%"
              }
            ]
          }
        }
      ]
    },
    {
      "type": "Category",
      "label": "Pregnancy",
      "options": {
        "icon": "condom"
      },
      "elements": [
        {
          "type": "Control",
          "label": "Pregnant:",
          "scope": "#/properties/familyPlanning/properties/pregnant"
        },
        {
          "type": "Control",
          "label": "Contraception:",
          "scope": "#/properties/familyPlanning/properties/contraception"
        }
      ]
    },
    {
      "type": "Category",
      "label": "GBV",
      "options": {
        "title": "Gender Based Violence",
        "icon": "gender-based-violence"
      },
      "elements": [
        {
          "type": "Control",
          "label": "Screened?",
          "scope": "#/properties/genderBasedViolence/properties/screened"
        },
        {
          "type": "Control",
          "label": "Type of GBV:",
          "scope": "#/properties/genderBasedViolence/properties/type"
        },
        {
          "type": "Control",
          "label": "Referred for External Services:",
          "scope": "#/properties/genderBasedViolence/properties/referredForExternalServices"
        },
        {
          "type": "Control",
          "label": "Intimate Partner Violence?",
          "scope": "#/properties/genderBasedViolence/properties/intimatePartnerViolence"
        },
        {
          "type": "Control",
          "label": "Rape?",
          "scope": "#/properties/genderBasedViolence/properties/rape"
        },
        {
          "type": "Control",
          "label": "Post GBV Services Provided?",
          "scope": "#/properties/genderBasedViolence/properties/postServiceProvided"
        },
        {
          "type": "Control",
          "label": "Post GBV Service Type:",
          "scope": "#/properties/genderBasedViolence/properties/receivedServiceType"
        }
      ]
    },
    {
      "type": "Category",
      "label": "Viral Load",
      "options": {
        "icon": "virus"
      },
      "elements": [
        {
          "type": "VerticalLayout",
          "elements": [
            {
              "type": "Control",
              "label": "Viral Load Done?",
              "scope": "#/properties/viralLoad/properties/tested"
            },
            {
              "type": "Control",
              "scope": "#/properties/viralLoad/properties/targeting",
              "label": "VL Targeting:",
              "options": {
                "show": [
                  ["TARGETED", "Targeted"],
                  ["SCHEDULED", "Scheduled"]
                ]
              }
            },
            {
              "type": "Control",
              "label": "Viral Load Result [copies/ml]",
              "scope": "#/properties/viralLoad/properties/viralLoadResult"
            },
            {
              "type": "DecisionTree",
              "scope": "#/properties/viralLoad/properties/viralLoadStatus",
              "options": {
                "basePath": "viralLoad",
                "tree": {
                  "root": "root",
                  "nodes": {
                    "root": {
                      "branches": [
                        {
                          "dataField": "viralLoadResult",
                          "greaterThan": 1000,
                          "value": "Unsuppressed"
                        },
                        {
                          "dataField": "viralLoadResult",
                          "lessThanOrEqualTo": 1000,
                          "value": "Suppressed"
                        }
                      ]
                    }
                  }
                }
              }
            },
            {
              "type": "EncounterLineChart",
              "scope": "#",
              "options": {
                "values": [
                  {
                    "field": "viralLoad.viralLoadResult",
                    "label": "Viral Load",
                    "unit": "copies/ml"
                  }
                ],
                "horizontalRulers": [
                  {
                    "position": 1000,
                    "colour": "red"
                  }
                ]
              }
            },
            {
              "type": "Control",
              "label": "EAC Done?",
              "scope": "#/properties/viralLoad/properties/eacDone"
            }
          ]
        }
      ]
    },
    {
      "type": "Category",
      "label": "Biochemistry",
      "options": {
        "icon": "microscope"
      },
      "elements": [
        {
          "type": "Control",
          "label": "AST [UI/L]",
          "scope": "#/properties/biochem/properties/ast"
        },
        {
          "type": "Control",
          "label": "ALT",
          "scope": "#/properties/biochem/properties/alt"
        },
        {
          "type": "Control",
          "scope": "#/properties/biochem/properties/bilirubin"
        },
        {
          "type": "Control",
          "label": "UEC (Cr)",
          "scope": "#/properties/biochem/properties/uec"
        },
        {
          "type": "Control",
          "label": "CD4 [+cells/mm^3]",
          "scope": "#/properties/biochem/properties/cd4"
        },
        {
          "type": "EncounterLineChart",
          "scope": "#",
          "options": {
            "values": [
              {
                "field": "biochem.cd4",
                "label": "CD4",
                "unit": "+cells/mm^3"
              }
            ]
          }
        }
      ]
    },
    {
      "type": "Category",
      "label": "Haematology",
      "options": {
        "icon": "test-tube"
      },
      "elements": [
        {
          "type": "Control",
          "label": "Hep B SAg:",
          "scope": "#/properties/haem/properties/hepBSAg"
        },
        {
          "type": "Control",
          "label": "RBSL/FBSL",
          "scope": "#/properties/haem/properties/rbslToFbsl"
        },
        {
          "type": "Group",
          "label": "FBE",
          "elements": [
            {
              "type": "Control",
              "label": "FBE Hb [g/dL]",
              "scope": "#/properties/haem/properties/fbe/properties/fbeHb"
            },
            {
              "type": "Control",
              "label": "FBE WCC",
              "scope": "#/properties/haem/properties/fbe/properties/fbeWCC"
            },
            {
              "type": "Control",
              "label": "FBE Plt",
              "scope": "#/properties/haem/properties/fbe/properties/fbePlt"
            }
          ]
        },
        {
          "type": "Control",
          "label": "TPHA:",
          "scope": "#/properties/haem/properties/tpha"
        },
        {
          "type": "Control",
          "label": "TLC [+cells/mm3]",
          "scope": "#/properties/haem/properties/tlc"
        }
      ]
    },
    {
      "type": "Category",
      "label": "Tuberculosis",
      "options": {
        "icon": "lungs"
      },
      "elements": [
        {
          "type": "Control",
          "label": "TB-Screening:",
          "scope": "#/properties/tuberculosis/properties/tbScreening"
        },
        {
          "type": "Control",
          "label": "TB-GeneXpert:",
          "scope": "#/properties/tuberculosis/properties/tbGeneXpert",
          "options": {
            "show": [
              ["NOT_DETECTED", "Not Detected"],
              ["POSITIVE_RIF_SENSITIVE", "Positive (Rif-Sensitive)"],
              ["POSITIVE_RIF_RESISTANT", "Positive (Rif-Resistant)"]
            ]
          }
        },
        {
          "type": "Control",
          "label": "CXR",
          "scope": "#/properties/tuberculosis/properties/cxr"
        },
        {
          "type": "Control",
          "label": "TB-Sputum:",
          "scope": "#/properties/tuberculosis/properties/tbSputum",
          "options": {
            "show": [
              ["NO_AFB", "No AFB"],
              ["POS_1", "+"],
              ["POS_2", "++"],
              ["POS_3", "+++"]
            ]
          }
        },
        {
          "type": "Control",
          "label": "TB-Status:",
          "scope": "#/properties/tuberculosis/properties/tbStatus",
          "options": {
            "show": [
              ["CONFMC", "TB confirmed clinically"],
              ["CONFMS", "TB confirmed by Sputum"],
              ["CONFMX", "TB confirmed by X-ray"],
              ["INH", "Currently on INH prophylaxis (IPT)"],
              ["NO", "Not suspected / no signs or symptoms"],
              ["REFER", "TB suspected and referred for evaluation"],
              [
                "SP",
                "TB suspected and sputums sample sent or results recorded"
              ],
              ["TBRX", "Currently on TB treatment"],
              ["TBRXC", "Has completed TB treatment, no signs or symptoms"],
              ["YES", "Has TB (code from old CTC form)"]
            ]
          }
        }
      ]
    },
    {
      "type": "Category",
      "label": "Index Testing",
      "options": {
        "icon": "index-testing"
      },
      "elements": [
        {
          "type": "Control",
          "label": "Index Testing Offered:",
          "scope": "#/properties/indexTesting/properties/indexTestingOffered"
        },
        {
          "type": "Control",
          "label": "IPV Risk?",
          "scope": "#/properties/indexTesting/properties/ipvRisk"
        },
        {
          "type": "Control",
          "label": "Index Testing Accepted?",
          "scope": "#/properties/indexTesting/properties/indexTestingAccepted"
        }
      ]
    },
    {
      "type": "Category",
      "label": "HCV / CrAg",
      "options": {
        "icon": "liver"
      },
      "elements": [
        {
          "type": "Control",
          "label": "HCV:",
          "scope": "#/properties/hcvCrag/properties/hcv"
        },
        {
          "type": "Control",
          "label": "CrAg Result:",
          "scope": "#/properties/hcvCrag/properties/crAgResult"
        },
        {
          "type": "Control",
          "scope": "#/properties/hcvCrag/properties/crAgTitre"
        }
      ]
    },
    {
      "type": "Category",
      "label": "Risk Behaviour",
      "options": {
        "icon": "document"
      },
      "elements": [
        {
          "type": "Label",
          "text": "Have you experienced any of the following in the past 12 months?",
          "variant": "h2"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/receivedBloodTransfusion"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/injectedDrugsWithoutDoctorAdvice"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/accidentalNeedlePick"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/sexualTransmittedInfection"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/unprotectedVaginalSex"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/unprotectedAnalSex"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/prostitution",
          "label": "Sex in exchange for money/goods/services"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/sexWithSameSex"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/forcedSexWithoutConsent"
        },
        {
          "type": "Spacer"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/numberMaleSexualPartners6Month"
        },
        {
          "type": "Control",
          "scope": "#/properties/riskBehaviour/properties/numberFemaleSexualPartners6Month"
        },
        {
          "type": "DecisionTree",
          "scope": "#/properties/riskBehaviour/properties/riskGroup",
          "options": {
            "basePath": "riskBehaviour",
            "tree": {
              "root": "root",
              "nodes": {
                "root": {
                  "branches": [
                    {
                      "patientField": "gender",
                      "equalTo": "MALE",
                      "node": "isMale"
                    },
                    {
                      "patientField": "gender",
                      "equalTo": "FEMALE",
                      "node": "isFemale"
                    },
                    {
                      "patientField": "gender",
                      "equalTo": "TRANSGENDER",
                      "node": "isTransgender"
                    }
                  ]
                },
                "isMale": {
                  "value": "LRM",
                  "branches": [
                    {
                      "dataField": "sexWithSameSex",
                      "equalTo": true,
                      "node": "maleSexWithSameSex"
                    },
                    {
                      "dataField": "unprotectedAnalSex",
                      "equalTo": true,
                      "node": "maleSexWithSameSex"
                    },
                    {
                      "dataField": "numberMaleSexualPartners6Month",
                      "greaterThan": 0,
                      "node": "maleSexWithSameSex"
                    },
                    {
                      "dataField": "forcedSexWithoutConsent",
                      "equalTo": true,
                      "node": "maleHadSexWithFemale"
                    },
                    {
                      "dataField": "numberFemaleSexualPartners6Month",
                      "greaterThan": 0,
                      "node": "maleHadSexWithFemale"
                    }
                  ]
                },
                "maleSexWithSameSex": {
                  "value": "MSM",
                  "branches": [
                    {
                      "dataField": "prostitution",
                      "equalTo": true,
                      "value": "MSMSW"
                    }
                  ]
                },
                "maleHadSexWithFemale": {
                  "value": "LRM",
                  "branches": [
                    {
                      "dataField": "numberFemaleSexualPartners6Month",
                      "greaterThan": 1,
                      "node": "maleHadSexWithMultiFemale"
                    }
                  ]
                },
                "maleHadSexWithMultiFemale": {
                  "value": "HRM",
                  "branches": [
                    {
                      "dataField": "prostitution",
                      "equalTo": true,
                      "value": "MSW"
                    }
                  ]
                },
                "isFemale": {
                  "value": "LRW",
                  "branches": [
                    {
                      "dataField": "unprotectedVaginalSex",
                      "equalTo": true,
                      "node": "femaleHadSex"
                    },
                    {
                      "dataField": "unprotectedAnalSex",
                      "equalTo": true,
                      "node": "femaleHadSex"
                    },
                    {
                      "dataField": "sexWithSameSex",
                      "equalTo": true,
                      "node": "femaleHadSex"
                    },
                    {
                      "dataField": "forcedSexWithoutConsent",
                      "equalTo": true,
                      "node": "femaleHadSex"
                    },
                    {
                      "dataField": "numberMaleSexualPartners6Month",
                      "greaterThan": 0,
                      "node": "femaleHadSex"
                    },
                    {
                      "dataField": "numberFemaleSexualPartners6Month",
                      "greaterThan": 0,
                      "node": "femaleHadSex"
                    }
                  ]
                },
                "femaleHadSex": {
                  "value": "LRW",
                  "branches": [
                    {
                      "dataField": "numberMaleSexualPartners6Month",
                      "greaterThan": 1,
                      "node": "femaleHadSexMulti"
                    },
                    {
                      "dataField": "numberFemaleSexualPartners6Month",
                      "greaterThan": 1,
                      "node": "femaleHadSexMulti"
                    }
                  ]
                },
                "femaleHadSexMulti": {
                  "value": "HRW",
                  "branches": [
                    {
                      "dataField": "prostitution",
                      "equalTo": true,
                      "value": "FSW"
                    }
                  ]
                },
                "isTransgender": {
                  "value": "TG",
                  "branches": [
                    {
                      "dataField": "prostitution",
                      "equalTo": true,
                      "value": "TGSW"
                    }
                  ]
                }
              }
            }
          }
        }
      ]
    },
    {
      "type": "Category",
      "label": "Referrals",
      "options": {
        "icon": "referrals"
      },
      "elements": [
        {
          "type": "Control",
          "label": "Referred to",
          "scope": "#/properties/referral/properties/referredTo"
        },
        {
          "type": "Control",
          "label": "Note",
          "scope": "#/properties/referral/properties/note",
          "options": {
            "multiline": true,
            "rows": 5
          }
        }
      ]
    }
  ],
  "options": {
    "variant": "tab"
  }
}
